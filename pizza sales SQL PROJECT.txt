	--SQL PROJECT 2
	--PIZZA HUT SALES
	--BY ALTAF SHAIKH

	--QUESTIONS AND SOLUTIONS


	--Retrieve the total number of orders placed.
	SELECT *FROM orders
	 SELECT COUNT (ORDER_ID) AS TOTAL_ORDER FROM ORDERS 



--Calculate the total revenue generated from pizza sales.
SELECT
ROUND(SUM(order_details.quantity *pizzas.price),2)As total_sales from order_details JOIN
pizzas ON pizzas.pizza_id =order_details.pizza_id


--Identify the highest-priced pizza.

select pizza_types.name,pizzas.price
from pizza_types join pizzas
on pizza_types.pizza_type_id=pizzas.pizza_type_id order by pizzas.price  desc;

--Identify the most common pizza size ordered.
select pizzas.size,count (order_details.order_details_id) as order_count
from pizzas join order_details
on pizzas.pizza_id=order_details.pizza_id
group by pizzas.size order by order_count desc;


--List the top 5 most ordered pizza types along with their quantities.
SELECT pizza_types.name,
SUM(order_details.quantity) AS quantity 
from pizza_types join pizzas
on pizza_types.pizza_type_id=pizzas.pizza_type_id
join order_details
on order_details.pizza_id=pizzas.pizza_id
group by pizza_types.name order by quantity desc;

--Intermediate:


--Join the necessary tables to find the total quantity of each pizza category
--ordered.
  select pizza_types.category,
  SUM(order_details.quantity)as quantity
  from pizza_types join pizzas
  on pizza_types.pizza_type_id=pizzas.pizza_type_id
  join order_details
  on order_details.pizza_id=pizzas.pizza_id
  group by pizza_types.category order by quantity desc;

  -- second method solve
  SELECT
    pt.category,
    SUM(CAST(od.quantity AS INT)) AS total_quantity_ordered
FROM
    pizza_types AS pt
JOIN
    pizzas AS p ON pt.pizza_type_id = p.pizza_type_id
JOIN
    order_details AS od ON od.pizza_id = p.pizza_id
GROUP BY
    pt.category
ORDER BY
    total_quantity_orderedÂ DESC;




--Determine the distribution of orders by hour of the day.
select *from orders
select HOUR(order_time) As hour,COUNT(order_id)AS order_count FROM orders GROUP BY HOUR(order_time);


--Join relevant tables to find the category-wise distribution of pizzas.

select category,count (name) from pizza_types group by category;

--Group the orders by date and calculate the average number of pizzas ordered per day.
select round(avg(quantity),0)
from 
(select orders.date,SUM(order_details.quantity)as quantity
from orders join order_details
on orders.order_id=order_details.order_id
group by orders.date) as order_quantity;
--or methods
select top 10* from orders


SELECT date, COUNT(order_id) AS order_count
FROM orders
GROUP BY date
ORDER BY date;


SELECT DATEPART(HOUR, time) AS order_hour,
       COUNT(order_id) AS order_count
FROM orders
GROUP BY DATEPART(HOUR, time)
ORDER BY order_hour desc;


--Determine the most ordered pizza types based on revenue.
select pizza_types.name,
SUM(order_details.quantity * pizzas.price) as revenue
from pizza_types join pizzas
on pizzas.pizza_type_id=pizza_types.pizza_type_id
join order_details
on order_details.pizza_id=pizzas.pizza_id
group by pizza_types.name order by revenue desc;
